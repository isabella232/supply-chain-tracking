/*!
 * Copyright © 2020 Splunk Inc.
 * SPLUNK CONFIDENTIAL – Use or disclosure of this material in whole or
 * in part without a valid written license from Splunk Inc. is PROHIBITED.
 */
module.exports =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 36);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

module.exports = require("react");

/***/ }),
/* 1 */
/***/ (function(module, exports) {

module.exports = require("styled-components");

/***/ }),
/* 2 */
/***/ (function(module, exports) {

module.exports = require("prop-types");

/***/ }),
/* 3 */
/***/ (function(module, exports) {

module.exports = require("@splunk/ui-utils/i18n");

/***/ }),
/* 4 */
/***/ (function(module, exports) {

module.exports = require("@splunk/themes");

/***/ }),
/* 5 */
/***/ (function(module, exports) {

module.exports = require("lodash/get");

/***/ }),
/* 6 */,
/* 7 */
/***/ (function(module, exports) {

module.exports = require("@splunk/react-icons/Close");

/***/ }),
/* 8 */,
/* 9 */,
/* 10 */,
/* 11 */,
/* 12 */
/***/ (function(module, exports) {

module.exports = require("@splunk/dashboard-context");

/***/ }),
/* 13 */,
/* 14 */,
/* 15 */,
/* 16 */,
/* 17 */
/***/ (function(module, exports) {

module.exports = require("@splunk/dashboard-context/DashboardApiContext");

/***/ }),
/* 18 */,
/* 19 */,
/* 20 */,
/* 21 */,
/* 22 */,
/* 23 */,
/* 24 */
/***/ (function(module, exports) {

module.exports = require("@splunk/react-ui/Button");

/***/ }),
/* 25 */
/***/ (function(module, exports) {

module.exports = require("@splunk/dashboard-utils/riskyCommandUtils");

/***/ }),
/* 26 */,
/* 27 */,
/* 28 */,
/* 29 */,
/* 30 */,
/* 31 */,
/* 32 */,
/* 33 */,
/* 34 */,
/* 35 */,
/* 36 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";

var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __read = (this && this.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var react_1 = __importStar(__webpack_require__(0));
var prop_types_1 = __importDefault(__webpack_require__(2));
var styled_components_1 = __importDefault(__webpack_require__(1));
var i18n_1 = __webpack_require__(3);
var Input_1 = __importDefault(__webpack_require__(37));
var Dropdown_1 = __importDefault(__webpack_require__(38));
var Button_1 = __importDefault(__webpack_require__(24));
var Close_1 = __importDefault(__webpack_require__(7));
var Link_1 = __importDefault(__webpack_require__(39));
var Scroll_1 = __importDefault(__webpack_require__(40));
var defaultSPLSyntax_json_1 = __importDefault(__webpack_require__(41));
var DashboardApiContext_1 = __importDefault(__webpack_require__(17));
var riskyCommandUtils_1 = __webpack_require__(25);
var dashboard_context_1 = __importDefault(__webpack_require__(12));
var url_1 = __webpack_require__(42);
var get_1 = __importDefault(__webpack_require__(5));
var themes_1 = __webpack_require__(4);
var dashboard_telemetry_1 = __webpack_require__(43);
var WarningContainer = styled_components_1.default.div(templateObject_1 || (templateObject_1 = __makeTemplateObject(["\n    width: 400px;\n    max-height: 375px;\n    padding: 24px;\n    color: ", ";\n    font-size: 14px;\n    background-color: ", ";\n"], ["\n    width: 400px;\n    max-height: 375px;\n    padding: 24px;\n    color: ", ";\n    font-size: 14px;\n    background-color: ", ";\n"])), themes_1.variables.contentColorDefault, themes_1.variables.backgroundColorPopup);
var BodyContainer = styled_components_1.default(Scroll_1.default)(templateObject_2 || (templateObject_2 = __makeTemplateObject(["\n    width: 100%;\n    max-height: 280px;\n    margin-bottom: 12px;\n"], ["\n    width: 100%;\n    max-height: 280px;\n    margin-bottom: 12px;\n"])));
var HeaderContainer = styled_components_1.default.div(templateObject_3 || (templateObject_3 = __makeTemplateObject(["\n    display: flex;\n    justify-content: space-between;\n"], ["\n    display: flex;\n    justify-content: space-between;\n"])));
var TitleContainer = styled_components_1.default.div(templateObject_4 || (templateObject_4 = __makeTemplateObject(["\n    height: 28px;\n    font-size: 17px;\n    font-weight: 500;\n"], ["\n    height: 28px;\n    font-size: 17px;\n    font-weight: 500;\n"])));
var CloseButton = styled_components_1.default(Button_1.default)(templateObject_5 || (templateObject_5 = __makeTemplateObject(["\n    width: 32px;\n    height: 32px;\n    flex-grow: 0;\n    margin-top: -8px;\n"], ["\n    width: 32px;\n    height: 32px;\n    flex-grow: 0;\n    margin-top: -8px;\n"])));
var FooterContainer = styled_components_1.default.div(templateObject_6 || (templateObject_6 = __makeTemplateObject(["\n    text-align: right;\n    margin-top: 16px;\n"], ["\n    text-align: right;\n    margin-top: 16px;\n"])));
var InputContainer = styled_components_1.default.div(templateObject_7 || (templateObject_7 = __makeTemplateObject(["\n    .disabled .ace_content {\n        opacity: 1;\n    }\n"], ["\n    .disabled .ace_content {\n        opacity: 1;\n    }\n"])));
var RiskyCommandsList = styled_components_1.default.div(templateObject_8 || (templateObject_8 = __makeTemplateObject(["\n    font-weight: 500;\n    color: ", ";\n    text-indent: 24px;\n    word-break: break-word;\n"], ["\n    font-weight: 500;\n    color: ",
    ";\n    text-indent: 24px;\n    word-break: break-word;\n"])), themes_1.pick({
    light: themes_1.variables.focusColor,
    dark: themes_1.variables.linkColor,
}));
var DescriptionText = styled_components_1.default.div.attrs(function () { return ({
    'data-test': 'risky-description-text',
}); })(templateObject_9 || (templateObject_9 = __makeTemplateObject(["\n    padding-top: 16px;\n    padding-bottom: 8px;\n"], ["\n    padding-top: 16px;\n    padding-bottom: 8px;\n"])));
var WarningText = styled_components_1.default.div(templateObject_10 || (templateObject_10 = __makeTemplateObject(["\n    font-weight: 500;\n    margin-top: 8px;\n    margin-bottom: 16px;\n"], ["\n    font-weight: 500;\n    margin-top: 8px;\n    margin-bottom: 16px;\n"])));
var closeReasons = ['escapeKey', 'offScreen', 'toggleClick', 'clickAway'];
var RiskyWarningPopover = function (_a) {
    var riskySearch = _a.riskySearch, message = _a.message, id = _a.id, statusIcon = _a.statusIcon, _b = _a.open, open = _b === void 0 ? false : _b, _c = _a.type, type = _c === void 0 ? 'visualization' : _c;
    var _d = __read(react_1.useState(open), 2), status = _d[0], setPopoverStatus = _d[1];
    var dashboardApi = react_1.useContext(DashboardApiContext_1.default);
    var telemetry = react_1.useContext(dashboard_telemetry_1.TelemetryContext);
    var handleClick = react_1.useCallback(function () {
        telemetry.emit({
            pageAction: 'riskyWarningDialog.runSearch',
            source: 'riskyWarningDialog',
            metadata: { type: type },
        });
        if (type === 'input') {
            dashboardApi.refreshInput(id, { checkRiskyCommand: false });
        }
        else {
            dashboardApi.refreshVisualization(id, { checkRiskyCommand: false });
        }
    }, [dashboardApi, id, type, telemetry]);
    var handleRequestClose = react_1.useCallback(function () {
        telemetry.emit({
            pageAction: 'riskyWarningDialog.cancel',
            source: 'riskyWarningDialog',
            metadata: { type: type },
        });
        setPopoverStatus(false);
    }, [telemetry, type]);
    var handleRequestOpen = react_1.useCallback(function () {
        telemetry.emit({
            pageAction: 'riskyWarningDialog.open',
            source: 'riskyWarningDialog',
            metadata: { type: type },
        });
        setPopoverStatus(true);
    }, [telemetry, type]);
    var userMessage = react_1.useContext(dashboard_context_1.default).userMessage;
    react_1.useEffect(function () {
        if (userMessage) {
            userMessage();
        }
    }, [userMessage]);
    var renderRiskyCommands = react_1.useMemo(function () { return (react_1.default.createElement(RiskyCommandsList, { "data-test": "risky-command-list" }, riskyCommandUtils_1.getRiskyCommands(message).join(', '))); }, [message]);
    var getRiskyCommandDocsUrl = function () {
        var instanceType = get_1.default(window, [
            '__splunkd_partials__',
            "/services/server/info",
            'entry',
            0,
            'content',
            'instance_type',
        ]);
        return instanceType === 'cloud'
            ? url_1.createDocsURL('sds.cloud-risky')
            : url_1.createDocsURL('sds.ent-risky');
    };
    var WarningDialog = react_1.useMemo(function () { return (react_1.default.createElement(WarningContainer, null,
        react_1.default.createElement(HeaderContainer, null,
            react_1.default.createElement(TitleContainer, null, type === 'input'
                ? i18n_1._('This input has a potential security risk')
                : i18n_1._('This visualization has a potential security risk')),
            react_1.default.createElement(CloseButton, { appearance: "pill", prepend: true, icon: react_1.default.createElement(Close_1.default, null), onClick: handleRequestClose, "data-test": "risky-warning-close-button" })),
        react_1.default.createElement(BodyContainer, { stopScrollPropagation: true },
            react_1.default.createElement(DescriptionText, null,
                i18n_1._('The search that you are about to run contains commands that might present a security risk.'),
                ' ',
                react_1.default.createElement(Link_1.default, { to: getRiskyCommandDocsUrl(), openInNewContext: true }, i18n_1._('Learn More'))),
            renderRiskyCommands,
            react_1.default.createElement(WarningText, null, i18n_1._('If the commands seem unusual, do not run the query without further investigation or contact your Splunk administrator.')),
            react_1.default.createElement(InputContainer, null,
                react_1.default.createElement(Input_1.default, { syntax: defaultSPLSyntax_json_1.default, showLineNumbers: false, maxLines: 4, value: riskySearch, enabled: false }))),
        i18n_1._('Do you want to run the search string?'),
        react_1.default.createElement(FooterContainer, null,
            react_1.default.createElement(Button_1.default, { label: i18n_1._('Run Query'), appearance: "primary", onClick: handleClick, "data-test": "risky-warning-run-button" }),
            react_1.default.createElement(Button_1.default, { label: i18n_1._('Cancel'), appearance: "secondary", onClick: handleRequestClose, "data-test": "risky-warning-cancel-button" })))); }, [
        handleRequestClose,
        renderRiskyCommands,
        riskySearch,
        handleClick,
        type,
    ]);
    return react_1.useMemo(function () { return (react_1.default.createElement(Dropdown_1.default, { defaultPlacement: "right", open: status, closeReasons: closeReasons, toggle: statusIcon, onRequestOpen: handleRequestOpen, onRequestClose: handleRequestClose, takeFocus: true, retainFocus: true }, WarningDialog)); }, [
        handleRequestClose,
        handleRequestOpen,
        status,
        statusIcon,
        WarningDialog,
    ]);
};
RiskyWarningPopover.propTypes = {
    statusIcon: prop_types_1.default.node.isRequired,
    riskySearch: prop_types_1.default.string.isRequired,
    id: prop_types_1.default.string.isRequired,
    message: prop_types_1.default.string.isRequired,
    open: prop_types_1.default.bool,
    type: prop_types_1.default.oneOf(['visualization', 'input']),
};
exports.default = react_1.default.memo(RiskyWarningPopover);
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8, templateObject_9, templateObject_10;


/***/ }),
/* 37 */
/***/ (function(module, exports) {

module.exports = require("@splunk/react-search/components/Input");

/***/ }),
/* 38 */
/***/ (function(module, exports) {

module.exports = require("@splunk/react-ui/Dropdown");

/***/ }),
/* 39 */
/***/ (function(module, exports) {

module.exports = require("@splunk/react-ui/Link");

/***/ }),
/* 40 */
/***/ (function(module, exports) {

module.exports = require("@splunk/react-ui/Scroll");

/***/ }),
/* 41 */
/***/ (function(module, exports) {

module.exports = require("@splunk/dashboard-utils/defaultSPLSyntax.json");

/***/ }),
/* 42 */
/***/ (function(module, exports) {

module.exports = require("@splunk/splunk-utils/url");

/***/ }),
/* 43 */
/***/ (function(module, exports) {

module.exports = require("@splunk/dashboard-telemetry");

/***/ })
/******/ ]);
//# sourceMappingURL=RiskyWarningPopover.js.map