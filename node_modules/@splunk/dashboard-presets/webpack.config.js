/* eslint-env node */
const path = require('path');
const webpackMerge = require('webpack-merge');
const webpack = require('webpack');
const {
    baseLibraryConfig,
    entries,
} = require('@splunk/dashboard-build-tools/webpack');

const watchIgnoreFiles = [
    /packages\/dashboard-presets\/[a-zA-Z_\-0-9]+\.js(\.map)?$/,
    /packages\/dashboard-presets\/utils\/[a-zA-Z_\-0-9]+\.js(\.map)?$/,
    /\.d\.ts(\.map)?$/,
];

module.exports = [
    webpackMerge(baseLibraryConfig, {
        entry: entries(path.join(__dirname, 'src')),
        output: {
            path: __dirname,
        },
        plugins: [new webpack.WatchIgnorePlugin([...watchIgnoreFiles])],
    }),
    webpackMerge(baseLibraryConfig, {
        entry: entries(path.join(__dirname, 'src/utils')),
        output: {
            path: path.resolve(__dirname, 'utils'),
        },
        plugins: [new webpack.WatchIgnorePlugin([...watchIgnoreFiles])],
    }),
];
